---
title: "Presidential Election Finance Data"
author: "Sarah Edelson, Seamus Lawton, Matthew Perkins"
date: "Date"
output:
  prettydoc::html_pretty:
    theme: architect
    thumbnails: false
    highlight: NULL
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
library(tidyverse)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(rvest)
library(here)
library(readr)
library(ggnetwork)
library(datasets)
library(mdsr)
library(gapminder)
library(igraph)
library(maps)
library(scales)
```

# Header 1

## Header 2

### Header 3

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For example, you can include **Bold** and _Italic_ and `Code` text.  For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

You should test out updating your GitHub Pages website:

- clone your group's blog project repo in RStudio
- update "Your Project Title Here" to a new title in the YAML header
- knit `index.Rmd` 
- commit and push BOTH the `index.Rmd` and the `index.html` files
- go to https://stat231-s21.github.io/Blog-Nate-Platinum/ to see the published test document (this is publicly available!)

## Including code and plots

You can embed code as normal, for example:

```{r cars}
summary(cars)
```

Let's clean up the format of that output:

```{r pretty, echo=FALSE, warning=FALSE, message=FALSE}
library(kableExtra)
summary(cars) %>%
  kable(col.names = c("Speed", "Distance")
        , row.names = F) %>%
  kable_styling(bootstrap_options = "striped"
                , full_width = F) %>%
  row_spec(0, bold = T, underline = T) %>%
  column_spec(1:2, width = "1.5in") 
```

In a study from the 1920s, fifty cars were used to see how the speed of the car and the distance taken to stop were related.  Speeds ranged between `r min(cars$speed)` and `r max(cars$speed)` mph.  Distances taken to stop ranged between `r min(cars$dist)` and `r max(cars$dist)` feet, with the middle 50% falling between `r as.numeric(quantile(cars$dist)[2])` and `r as.numeric(quantile(cars$dist)[4])` feet.  

You can also embed plots as normal, for example:
## Independent Expenditures for Joe Biden & Donald Trump


```{r figure1, echo=FALSE}
independent_expenditures <- read_csv(here("Data", "IndependentExpenditures.csv"))

independent_expenditures <- independent_expenditures %>%
  mutate(candidate_cleaned_ie = (case_when(
         str_detect(candidate_name, "BIDEN, JOSEPH R JR") ~ "Joe Biden",
         str_detect(candidate_name, "BLOOMBERG, MICHAEL R.") ~ "Michael Bloomberg",
         str_detect(candidate_name, "HARRIS, KAMALA D.") ~ "Kamala Harris",
         str_detect(candidate_name, "KLOBUCHAR, AMY J.") ~ "Amy Klobuchar",
         str_detect(candidate_name, "SANDERS, BERNARD") ~ "Bernie Sanders",
         str_detect(candidate_name, "STEYER, TOM") ~ "Tom Steyer",
         str_detect(candidate_name, "TRUMP, DONALD J.") ~ "Donald Trump",
         str_detect(candidate_name, "WARREN, ELIZABETH") ~ "Elizabeth Warren",
         str_detect(candidate_name, "YANG, ANDREW MR.") ~ "Andrew Yang"
         )))
  

independent_expenditures_large <- independent_expenditures %>%
  select(committee_name, candidate_cleaned_ie, total, support_oppose_indicator) %>%
  filter(total >= 10000000)  %>%
  filter(candidate_cleaned_ie == "Donald Trump" | candidate_cleaned_ie == "Joe Biden")

g_expenditures <- graph_from_data_frame(independent_expenditures_large, directed = TRUE)

expenditures_network <- ggnetwork(g_expenditures) %>%
  mutate(candidate = case_when(name == "Donald Trump" ~ "Donald Trump", 
                               name == "Joe Biden" ~ "Joe Biden",
                               TRUE ~ ""))

# Color by support or oppose
ggplot(data = expenditures_network, aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_edges(aes(size = total/1000000, color = support_oppose_indicator)) + geom_nodes() +
  geom_nodelabel(data = filter(expenditures_network, name!= "Donald Trump" & name != "Joe Biden"), aes(label = name), color = "black", size = 1.5) +
  geom_nodelabel(data = filter(expenditures_network, name == "Donald Trump"), aes(label = name), color = "blue", size = 4) +
  geom_nodelabel(data = filter(expenditures_network, name == "Joe Biden"), aes(label = name), color = "blue", size = 4) +
  theme_blank() +
  scale_color_manual(values=c("red2", "slategray")) +
  labs(size = "Contribution Size (millions)") +
  labs(color = "Support or Oppose Candidate") +
  ggtitle("Independent Expenditures Over 10 million") +
  theme(legend.title = element_text(size = 8)) +
  theme(legend.text = element_text(size = 8)) +
  theme(legend.position = "bottom")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


## Including links and images

You can include [Links](https://www.datadreaming.org/post/r-markdown-theme-gallery/) and images ![team logo](https://raw.githubusercontent.com/stat231-s21/Blog-Nate-Platinum/main/images/S1-politics.jpg)

You can embed a gif.

![pugs](https://media.giphy.com/media/XHVmD4RyXgSjd8aUMb/giphy.gif)

# You can even create tabs if you want! {.tabset .tabset-fade .tabset-pills}

## Bulleted list

You can make a bulleted list like this:

- item 1
- item 2
- item 3


## Numbered list

You can make a numbered list like this

1. First thing I want to say
2. Second thing I want to say
3. Third thing I want to say

